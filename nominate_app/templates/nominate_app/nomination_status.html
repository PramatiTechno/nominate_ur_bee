{% extends 'base.html' %}
{% block content %}
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<br>
<div class="container">
  <nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      {% for form in award_forms %}
        <a class="nav-item nav-link tab_forms {% if form.name ==  "Team Of Month" %} active {% endif %}" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true" value={{ form.id }}>{{ form.name }}</a>
        
      {% empty %}
        <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">No Awards Found</a>
      {% endfor %}
    </div>
  </nav>
  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
          <div id="collapseThree" class="collapse show" data-parent="#accordion">
      <div class="card-body">
        <div class="container" >
          <form>
      <table class="table" border="1" id="nomination_status_table">
        <tbody>
          <tr class="d-flex">
            <th class="col-10" style="padding-bottom: 6px; padding-top: 0;">Employee Name</th>
            <th class="col-2" style="padding-bottom: 6px; padding-top: 0;">Status</th>
          </tr>
          {% for form in nomination_status %}
            <tr class="d-flex">
              <td class="col-10" style="padding-bottom: 6px; padding-top: 0;"> {{ form.user.name }} </td>
              <td class="col-2" style="padding-bottom: 6px; padding-top: 0;"> {{ form.status }} </td>
            </tr>
          {% empty %}
            <tr class="d-flex">
              <td class="col-10" style="padding-bottom: 6px; padding-top: 0;"> No Nominations Found </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </form>
  </div>
</div>
</div>
    </div>
  </div>
  </div>
</div>

<script>

$(document).on('click', '.tab_forms', function(event) {
  award_id=$(this).attr('value');
  $.ajax({
  url:'/nomination_status_load/' + award_id + '/',
  type:'GET',
  dataType: 'json',
  data: { csrfmiddlewaretoken: '{{ csrf_token }}' },
  success:function (json) {
      var length = json.length
      debugger
      if (length == 0)
        {
          data='No Nomination Records Found For Selected Award'
          $('#nomination_status_table').html(data);
        }
      else
        {
          data=''
          $('#nomination_status_table').html(data);
        }
      for (i = 0; i <= length-1 ; i++) 
      {
          data='<tr class="d-flex"><td class="col-10" style="padding-bottom: 6px; padding-top: 0;"> '+ json[i].fields.template_name +' </td><td class="col-2" style="padding-bottom: 6px; padding-top: 0;"><a href="/edit_award_template/'+json[i].pk+'" type="button" class="btn btn-success" value="View" >View</a></td></tr>'
          $('#nomination_status_table').append(data);
      }
    }
  });
});

</script>
{% endblock %}